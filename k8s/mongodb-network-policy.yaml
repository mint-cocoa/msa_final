apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: mongodb-network-policy
spec:
  podSelector:
    matchExpressions:
    - {key: app, operator: In, values: [mongodb-facility, mongodb-park, mongodb-structure, mongodb-ticket]}
  policyTypes:
  - Ingress
  ingress:
  - from:
    - podSelector:
        matchExpressions:
        - {key: app, operator: In, values: [facility-service, park-service, structure-manager, ticket-service]}
    ports:
    - protocol: TCP
      port: 27017
  - from:
    - ipBlock:
        cidr: 0.0.0.0/0  # 외부 접근 허용 (실제 운영환경에서는 특정 IP 범위로 제한하는 것이 좋습니다)
    ports:
    - protocol: TCP
      port: 27017 